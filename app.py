import streamlit as st
import matplotlib.pyplot as plt
import pandas as pd
from io import StringIO
import json
import numpy as np
# -----------------------------
# Contenus des CSV intégrés
# -----------------------------
VARIANT_MEAN_CSV = """variant,GroupCount,mean_capi,mean_hplc,mean_ief,mean_agaracid,mean_reverse
A,20,150,1.7184,0.01,0.01,10
A2,25,243,2.82736,0.8132,0.01,17.0964329067
Abruzzo,4,177.25,2.7175,-3.475,3.2,9.8275
Agenogi,3,226.333333333333,4.19,-12.8666666666667,7.16666666666667,8.53333333333333
Al Hammadi Riyadh,2,206,3.325,-6.75,0.01,20.155
Andrew Minneapolis,2,122,1.415,3.7,-2.5,14.4
Angers,1,150,1.72,-1.5,-1,19.5
Ankara,1,85,1.45,6.8,0.01,8.8
Argenteuil,1,150,1.71,-0.7,0.01,20.6
Arya,3,219,3.47666666666667,-9.16666666666667,2.00333333333333,20
Athens Georgia,25,161.88,1.7292,-1.244,-0.0702800000000001,10.2204
Barbizon,2,116.5,1.4,4.05,-2.45,23.6
Bari,1,150,1.45,0.01,0.01,21.1
Bassett,1,184,3.68,-7.7,6.5,21.4
Belfast,1,212,3.27,-7.6,0.01,4.5
Belfort,1,169,3.52,-3.8,5.6,9.4
Beograd,2,207,3.185,-7.7,0.01,15.5
Bibba,1,150,1.74,0.01,0.01,20
Boghe,1,150,1.72,0.11,0.01,24.2
Bologna-St Orsola,2,150,1.295,1.1,-3.5,13.95
Bougardirey Mali,1,150,1.73,-3.5,0.01,18.8
Boumerdes,8,175.75,3.72875,-4.825,6.3375,19.0625
Brazzaville,1,158,1.78,-0.5,0.01,12
Brest,2,150,1.74,0.5,0.01,8.3
Buffalo,2,150,1.305,0.01,0.01,22.4
C,15,251.6,4.3876,-16,10,7.96340588338631
C-Ndjamena,1,223,3.45,-10.7,2.1,2.5
Camden,6,133.5,1.245,2.35,-1.95,11.15
Camperdown,16,141.5625,0.8,2.181875,-2.4875,13.60625
Canterbury,1,150,1.73,0.2,0.01,10.21
Canuts,3,198,3.75666666666667,-8.83333333333333,0.01,18.3666666666667
Chad,2,243,4.06,-10.75,6.25,18.3
Charolles,2,160,2.5,-0.3,0.01,28.9
Chiapas,1,192,3.17,-6.3,0.01,17.2
Chicago,6,150,1.735,-1.01666666666667,0.01,14.3333333333333
Choisy Anti Biskra,1,232,4,-9.2,5,17.9
City Of Hope,1,150,1.74,0.01,0.01,12.3
Cochin Port Royal,2,178.5,2.155,-3.2,0.0105,10
Constant Spring,1,264,4.53,-17,5.51,18.3
Corbeil,1,214,1.44,-10.8,-2.2,10.4
Cork,1,150,1.74,0.01,0.01,10
D Ibadan,1,211,3.15,-8.5,0.01,8.4
D Iran,28,199.571428571429,2.64321428571429,-7.24285714285715,0.01,8.68571428571429
D Ouled Rabah,49,206.530612244898,2.78142857142857,-7.14489795918367,0.01,8.48367346938776
D Punjab,427,207.714285714286,3.18578454332553,-7.30163934426229,0.01,8.39206088992974
Daneshgah Tehran,1,212,1.74,-5,0.01,20
Debrousse,2,159,1.69,-0.7,0.01,6.3
Decines Charpieu,1,150,1.73,0.2,0.01,17
Deer Lodge,2,187.5,2.725,-5.205,0.01,10
Denmark Hill,1,179,1.72,-4,0.01,20.7
Die,2,150,2.585,0.055,0.01,17.85
Djelfa,1,223,4.11,-12.6,0.01,6.3
Dunn,2,171.5,3.18,-6.9,0.01,20
E,14,227.857142857143,2.76557142857143,-15.2357142857143,0.01,5.36459369986827
E Saskatoon,7,242,3.20142857142857,-15.3,0.01,7.08571428571429
F Sardinia,1,182,1.71,-3,0.01,21.5
Fannin Lubbock Ii,1,121,1.6,3.5,0.01,12.5
Flurlingen,2,150,1.72,0.01,0.01,24.6
Fontainebleau,13,150,2.52,1.26153846153846,0.01,19.2692307692308
Fort De France,64,215.5,2.92390625,-8.965625,0.01,20
G Copenhagen,11,212.454545454545,2.83,-9.48181818181818,0.01,9.44545454545455
G Coushatta,24,198.875,2.56875,-6.4875,0.01,11.225
G Georgia,2,182,1.74,-3.9,0.01,29.25
G Norfolk,1,197,3.41,-8.5,0.01,20
G Philadelphie,134,205.835820895522,3.31626865671642,-6.76044776119403,0.01,18.1686567164179
G Rampa,1,181,1.7,-4.2,0.01,18.6
G San Jose,9,181.333333333333,3.55888888888889,-5.23333333333333,6.11111111111111,8.78888888888889
G Siriraj,2,198.5,4.355,-11.8,10,7.45
G Szuhu,1,207,3.61,-6,5.6,8.7
G Taichung,4,185.25,3.615,-6.375,4.4,16.85
G-Waimanolo,1,207,3.43,-7.8,0.01,20
Galliera Ii,2,171,3.185,-5.75,0.01,19.45
Gerland,2,150,2.585,0.01,0.01,20
Godavari,1,180,1.76,-4.4,0.01,20
Goree,2,206,3.425,-8.7,4.5,19.7
Grady,57,99.6140350877193,1.57350877192982,5.15964912280702,0.01,28.7087719298246
Grifton,1,178,1.61,-3.1,0.01,24.7
Groene Hart,5,150,1.714,0.01,0.01,43
Haaglanden,1,180,3.53,-5.4,6.5,10
Hamilton,2,150,1.75,0.01,0.01,11.9
Handsworth,3,212.666666666667,3.52333333333333,-7.1,0.01,18.6333333333333
Harrow,1,150,1.77,1.1,0.01,4
Hasharon,21,218.47619047619,4.21761904761905,-9.11952380952381,6.22380952380952,18.8619047619048
Hekinan,1,150,1.71,2.3,0.01,19.7
Hijiyama,1,41,0.87,11.4,0.01,13.8
Hikari,1,97,1.65,6.8,0.01,10.9
Himeji,4,110.5,1.49,3.375,-3.125,6.125
Hofu,6,92.8333333333333,1.72333333333333,5.71666666666667,0.01,2.78333333333333
Hope,291,132.917525773196,0.863470790378007,1.50378006872852,-3.41752577319588,10.4865979381443
Hopkins Ii,7,105.285714285714,1.43428571428571,8.48571428571429,0.01,27.8857142857143
Hornchurch,1,230,3.38,-16,0.01,6.6
Hotel Dieu,3,169.333333333333,3.38333333333333,-2.7,3.1,10
I Texas,9,14.1111111111111,1.41111111111111,11.6333333333333,0.01,22.1111111111111
J Abidjan,3,92,1.34,4.7,0.01,20
J Anatolia,3,87,1.44,7.2,0.01,23.2
J Auckland,1,116,1.74,4.3,0.01,10.7
J Baltimore,109,81.1009174311927,1.52917431192661,7.51284403669725,0.01,10.551376146789
J Bangkok,6,96.1666666666667,1.64166666666667,7.41666666666667,0.01,10.7833333333333
J Broussais,82,97.5609756097561,1.32353658536585,6.78658536585366,0.01,22.7426829268293
J Calabria,1,106,1.66,4.7,0.01,11.8
J Camaguey,1,106,1.33,3.5,0.01,22.4
J Cape Town,15,122,1.042,6.07333333333333,-0.232,22.68
J Chicago,1,98,1.55,7.5,0.01,8.2
J Meerut,8,103.75,1.6875,5.8875,0.01,19.1375
J Mexico,36,84.9722222222222,1.42222222222222,6.73055555555555,0.01,20
J Norfolk,1,67,1.32,6.5,0.01,20.8
J Oxford,1,78,1.5,6.5,0.01,20.3
J Paris,2,80.5,1.55,7.05,0.01,20
J Rovigo,4,68.5,1.305,6.95,0.01,20
J Tongariki,2,104.5,1.585,5.95,0.01,17.6
J Toronto,10,95.8,1.579,6.59,0.01,20
Jura,3,143.666666666667,1.71666666666667,-1.33666666666667,0.01,30.9666666666667
K Ibadan,1,75,1.69,7.7,0.01,13.4
K Woolwich,32,123.25,0.724375,3.546875,-2.875,12.509375
Karlskoga,2,205.5,3.115,-9.2,0.01,4.3
Kenitra,1,207,3.09,-9.2,0.01,12.2
Kenya,2,218.5,2.66,-11.25,-4,12.75
Knossos,9,150,1.72222222222222,-0.244444444444444,0.01,5.44444444444444
Korle Bu,194,202.510309278351,3.07113402061856,-7.53871134020619,0.00995360824742269,9.99690721649485
Kurosaki,1,37,1.32,9.9,0.01,21.2
La Desirade,13,150,1.72076923076923,0.177692307692308,0.01,14.3846153846154
La Pommeraie,2,150,1.73,-0.35,0.01,7.55
Lansing,1,150,1.73,-4.2,0.01,24.7
Lansing-Ramathibodi,1,176,1.71,-3.2,0.01,24.9
Le Lamentin,23,150,1.44217391304348,3.08260869565217,0.01,22.8652173913044
Lepore,104,206.057692307692,2.77096153846154,-6.6125,0.01,9.0175
Lepore Baltimore,28,204.428571428571,2.72535714285714,-6.68928571428571,0.01,10.75
Limassol,1,83,1.31,6.5,-2,11
Little Rock,2,150,1.335,0.105,-3.25,11.2
Lyon Bron,3,150,1.49666666666667,0.603333333333333,0.01,21.1333333333333
M Boston,2,150,3.7,-4.05,5,27.7
M Saskatoon,1,150,2.51,-0.5,0.01,23.2
Mac Kees Rock,1,150,1.31,2.2,-2.6,14.5
Malmo,1,150,1.38,3.7,-1.5,13
Manitoba,3,172.666666666667,3.5,-3.96666666666667,4.16666666666667,7.56666666666667
Manukau,1,150,2.51,0.01,0.01,10
Maputo,5,201.6,2.896,-9.3,0.01,11.4
Marineo,3,150,1.75333333333333,0.01,0.01,11.6666666666667
Matsue Oki,23,208.260869565217,3.32739130434783,-6.55652173913043,0.00960869565217392,20
Memphis,3,208.333333333333,3.45,-4.2,4.83333333333333,20
Montfermeil,1,150,1.72,0.5,0.01,15.8
Moscva,2,101.5,1.73,6.5,0.01,8.4
Muskegon,1,207,3.72,-6.7,6.5,10
N Baltimore,13,70.8461538461538,1.54615384615385,11.5923076923077,0.01,14.2076923076923
Neuilly Sur Marne,1,82,1.45,7,0.01,23.1
New Berlin,1,130,1.71,1.5,0.01,27.9
New York,11,122.181818181818,1.72090909090909,2.04545454545455,0.01,6.77272727272727
Nigeria,1,61,1.7,0.1,0.01,20.8
Niigata,1,150,0.69,-0.7,-1.7,11.2
Niort,1,150,2.51,0.01,0.01,12.9
Nouakchott,19,137.210526315789,1.71631578947368,-2.97368421052632,0.01,49.2368421052632
O Arab,76,241,3.97394736842105,-14.9894736842105,4.29473684210526,4.58947368421053
O Indonesia,6,215.666666666667,3.96833333333333,-15.25,5.75,13.3333333333333
O Padova,2,224.5,3.925,-12.2,8.3,18.25
Okazaki,1,175,3.38,-3.1,3.1,5.6
Old Dominion,1,145,1.49,0.01,-3,11.5
Oleander,2,207.5,3.155,-7.45,0.01,18.45
Olympia,9,150,1.71555555555556,0.01,0.01,10
Osu Christianborg,4,208.5,2.8525,-9.25,0.01,10
Owari,1,150,1.7,-1.6,0.01,17.5
P Galveston,1,196,2.4,-7,0.01,9.5
P Nilotic,9,194.555555555556,1.71111111111111,-4.74444444444444,0.01,16.8555555555556
Perth,1,150,1.74,0.01,0.01,-1.1
Phou Bia,1,160,2.4,-0.6,-2,12.1
Potomac,1,150,1.71,0.01,0.01,9.5
Pyrgos,1,98,1.33,5.5,-2.7,12.4
Q India,5,206.4,3.934,-8.14,5.02,17.5
Q Iran,3,206.333333333333,4.11,-7.76666666666667,6.06666666666667,18.1666666666667
Raleigh,1,150,0.73,1.5,-4.4,11.5
Rampa,1,107,1.7,-4.6,0.01,18.8
Reims,1,209,3.51,-4.7,4.01,19
Rhode Island,1,150,1.71,1.5,0.01,16.2
Riccarton,1,150,1.72,0.01,0.01,20
Roanne,1,170,1.73,-1,-0.51,20
Rothschild,2,202.5,3.28,-11.55,2.75,-0.8
Russ,3,213.666666666667,3.47333333333333,-6,2.16666666666667,19.0333333333333
S,21,214.047619047619,3.38738095238095,-8.5,5.6,11.269321966826
S-Antilles,3,213.333333333333,3.53,-9.33333333333333,5.6,13.8666666666667
Saint Mande,5,168,3.24,-2.16,0.01,14
Saint Nazaire,5,150,1.74,0.2,0.01,11.74
San Diego,10,150,1.697,0.68,0.01,11.01
Savaria,3,221.333333333333,3.56666666666667,-9.36666666666667,3.6,19.1333333333333
Seal Rock,2,232.5,3.93,-9.5,0.01,20
Setif,24,194.875,3.85583333333333,-11.275,6.70416666666667,21.5208333333333
Sfax,1,188,1.7,-5.6,0.01,11.4
Shaare Zedeck,1,17,0.56,11.4,0.01,22.2
Silver Springs,2,150,2.3,0.01,0.01,7.45
Spanish Town,10,202,2.94,-1.59,0.01,20
St Lukes,3,197.666666666667,3.61666666666667,-8.73333333333333,6.03333333333333,13.6
St Rose,1,75,1.73,6.6,7,21.4
Stanleyville Ii,11,209.818181818182,3.34181818181818,-8.4,0.01,19.4272727272727
Strasbourg,1,121,1.71,2.1,0.01,5.7
Summer Hill,18,206.722222222222,3.24611111111111,-9.3,0.01,7.72222222222222
Suresnes,3,99.3333333333333,1.71666666666667,1.83333333333333,0.01,20
Tacoma,1,129,2.23,1,0.01,16
Tak,3,186,3.26,-4.33333333333333,5.7,15.2
Tarrant,1,177,3.28,-4.5,5.61,17.4
Tatras,11,99.7272727272727,1.49,3.6,0.01,21
Thionville,1,123,0.98,6.5,0.01,23
Tigraye,1,205,4.31,-4.9,7.5,6.1
Titusville,1,181,3.75,-11,7,18.9
Toulon,1,159,3.02,-2,-3.3,17
Tsukumi,1,150,1.68,2.3,-3.1,25
Twin Peaks,1,150,3.11,-0.5,0.01,-3.8
Ty Gard,1,150,1.72,1,0.01,17.3
Ulm,1,89,1.66,7.5,0.01,13
Valletta,2,150,1.74,0.01,0.01,7.8
Verdun,1,174,3.35,-4,3,22
Villeurbanne,1,146,1.41,0.51,0.01,23.7
Watts,4,207,3.47,-9.325,0.01,18.7
Willamette,2,191.5,2.94,-9.05,0.01,7.65
Winnipeg,132,197.689393939394,3.53431818181818,-6.42954545454545,0.01,20
Yaizu,1,205,3.7,-6.3,6.6,10
Yaounde,2,150,1.735,0.01,0.01,5.15
Zaire,2,104,1.715,3.505,0.01,20
"""

BOUNDS_LOWER_CSV = """capi,hplc,ief,agaracid,reverse
146.513887722038,1.64580477726002,-0.378116312221364,-1.04467189974901,9.53845673732888
239.513887722038,2.75476477726002,0.425083687778636,-1.04467189974901,16.6348896440289
173.763887722038,2.64490477726002,-3.86311631222136,2.14532810025099,9.36595673732888
222.847221055371,4.11740477726002,-13.254782978888,6.11199476691765,8.07179007066222
202.513887722038,3.25240477726002,-7.13811631222136,-1.04467189974901,19.6934567373289
118.513887722038,1.34240477726002,3.31188368777864,-3.55467189974901,13.9384567373289
146.513887722038,1.64740477726002,-1.88811631222136,-2.05467189974901,19.0384567373289
81.5138877220377,1.37740477726002,6.41188368777864,-1.04467189974901,8.33845673732888
146.513887722038,1.63740477726002,-1.08811631222136,-1.04467189974901,20.1384567373289
215.513887722038,3.40407144392669,-9.55478297888803,0.948661433584321,19.5384567373289
158.393887722038,1.65660477726002,-1.63211631222136,-1.12495189974901,9.75885673732889
113.013887722038,1.32740477726002,3.66188368777864,-3.50467189974901,23.1384567373289
146.513887722038,1.37740477726002,-0.378116312221364,-1.04467189974901,20.6384567373289
180.513887722038,3.60740477726002,-8.08811631222136,5.44532810025099,20.9384567373289
208.513887722038,3.19740477726002,-7.98811631222136,-1.04467189974901,4.03845673732888
165.513887722038,3.44740477726002,-4.18811631222136,4.54532810025099,8.93845673732888
203.513887722038,3.11240477726002,-8.08811631222136,-1.04467189974901,15.0384567373289
146.513887722038,1.66740477726002,-0.378116312221364,-1.04467189974901,19.5384567373289
146.513887722038,1.64740477726002,-0.278116312221364,-1.04467189974901,23.7384567373289
146.513887722038,1.22240477726002,0.711883687778636,-4.55467189974901,13.4884567373289
146.513887722038,1.65740477726002,-3.88811631222136,-1.04467189974901,18.3384567373289
172.263887722038,3.65615477726002,-5.21311631222136,5.28282810025099,18.6009567373289
154.513887722038,1.70740477726002,-0.888116312221364,-1.04467189974901,11.5384567373289
146.513887722038,1.66740477726002,0.111883687778636,-1.04467189974901,7.83845673732888
146.513887722038,1.23240477726002,-0.378116312221364,-1.04467189974901,21.9384567373289
248.113887722038,4.31500477726002,-16.3881163122214,8.94532810025099,7.50186262071519
219.513887722038,3.37740477726002,-11.0881163122214,1.04532810025099,2.03845673732888
130.013887722038,1.17240477726002,1.96188368777864,-3.00467189974901,10.6884567373289
138.076387722038,0.727404777260022,1.79375868777864,-3.54217189974901,13.1447067373289
146.513887722038,1.65740477726002,-0.188116312221364,-1.04467189974901,9.74845673732889
194.513887722038,3.68407144392669,-9.2214496455547,-1.04467189974901,17.9051234039955
239.513887722038,3.98740477726002,-11.1381163122214,5.19532810025099,17.8384567373289
156.513887722038,2.42740477726002,-0.688116312221364,-1.04467189974901,28.4384567373289
188.513887722038,3.09740477726002,-6.68811631222136,-1.04467189974901,16.7384567373289
146.513887722038,1.66240477726002,-1.40478297888803,-1.04467189974901,13.8717900706622
228.513887722038,3.92740477726002,-9.58811631222136,3.94532810025099,17.4384567373289
146.513887722038,1.66740477726002,-0.378116312221364,-1.04467189974901,11.8384567373289
175.013887722038,2.08240477726002,-3.58811631222136,-1.04417189974901,9.53845673732888
260.513887722038,4.45740477726002,-17.3881163122214,4.45532810025099,17.8384567373289
210.513887722038,1.36740477726002,-11.1881163122214,-3.25467189974901,9.93845673732888
146.513887722038,1.66740477726002,-0.378116312221364,-1.04467189974901,9.53845673732888
207.513887722038,3.07740477726002,-8.88811631222136,-1.04467189974901,7.93845673732888
196.085316293466,2.57061906297431,-7.63097345507851,-1.04467189974901,8.22417102304317
203.044499966936,2.70883334868859,-7.53301427140504,-1.04467189974901,8.02213020671664
204.228173436323,3.11318932058555,-7.68975565648366,-1.04467189974901,7.93051762725862
208.513887722038,1.66740477726002,-5.38811631222136,-1.04467189974901,19.5384567373289
155.513887722038,1.61740477726002,-1.08811631222136,-1.04467189974901,5.83845673732888
146.513887722038,1.65740477726002,-0.188116312221364,-1.04467189974901,16.5384567373289
184.013887722038,2.65240477726002,-5.59311631222136,-1.04467189974901,9.53845673732888
175.513887722038,1.64740477726002,-4.38811631222136,-1.04467189974901,20.2384567373289
146.513887722038,2.51240477726002,-0.333116312221364,-1.04467189974901,17.3884567373289
219.513887722038,4.03740477726002,-12.9881163122214,-1.04467189974901,5.83845673732888
168.013887722038,3.10740477726002,-7.28811631222136,-1.04467189974901,19.5384567373289
224.371030579181,2.69297620583145,-15.6238305979357,-1.04467189974901,4.90305043719716
238.513887722038,3.12883334868859,-15.6881163122214,-1.04467189974901,6.62417102304317
178.513887722038,1.63740477726002,-3.38811631222136,-1.04467189974901,21.0384567373289
117.513887722038,1.52740477726002,3.11188368777864,-1.04467189974901,12.0384567373289
146.513887722038,1.64740477726002,-0.378116312221364,-1.04467189974901,24.1384567373289
146.513887722038,2.44740477726002,0.873422149317098,-1.04467189974901,18.8076875065597
212.013887722038,2.85131102726002,-9.35374131222136,-1.04467189974901,19.5384567373289
208.968433176583,2.75740477726002,-9.86993449403955,-1.04467189974901,8.98391128278343
195.388887722038,2.49615477726002,-6.87561631222136,-1.04467189974901,10.7634567373289
178.513887722038,1.66740477726002,-4.28811631222136,-1.04467189974901,28.7884567373289
193.513887722038,3.33740477726002,-8.88811631222136,-1.04467189974901,19.5384567373289
202.34970861756,3.24367343397644,-7.1485640734154,-1.04467189974901,17.7071134537468
177.513887722038,1.62740477726002,-4.58811631222136,-1.04467189974901,18.1384567373289
177.847221055371,3.48629366614891,-5.6214496455547,5.0564392113621,8.32734562621777
195.013887722038,4.28240477726002,-12.1881163122214,8.94532810025099,6.98845673732888
203.513887722038,3.53740477726002,-6.38811631222136,4.54532810025099,8.23845673732888
181.763887722038,3.54240477726002,-6.76311631222136,3.34532810025099,16.3884567373289
203.513887722038,3.35740477726002,-8.18811631222136,-1.04467189974901,19.5384567373289
167.513887722038,3.11240477726002,-6.13811631222136,-1.04467189974901,18.9884567373289
146.513887722038,2.51240477726002,-0.378116312221364,-1.04467189974901,19.5384567373289
176.513887722038,1.68740477726002,-4.78811631222136,-1.04467189974901,19.5384567373289
202.513887722038,3.35240477726002,-9.08811631222136,3.44532810025099,19.2384567373289
96.127922809757,1.50091354918985,4.77153281058565,-1.04467189974901,28.2472286671534
174.513887722038,1.53740477726002,-3.48811631222136,-1.04467189974901,24.2384567373289
146.513887722038,1.64140477726002,-0.378116312221364,-1.04467189974901,42.5384567373289
176.513887722038,3.45740477726002,-5.78811631222136,5.44532810025099,9.53845673732888
146.513887722038,1.67740477726002,-0.378116312221364,-1.04467189974901,11.4384567373289
209.180554388704,3.45073811059336,-7.48811631222136,-1.04467189974901,18.1717900706622
146.513887722038,1.69740477726002,0.711883687778636,-1.04467189974901,3.53845673732888
214.990078198228,4.14502382487907,-9.50764012174518,5.16913762406051,18.4003614992336
146.513887722038,1.63740477726002,1.91188368777864,-1.04467189974901,19.2384567373289
37.5138877220377,0.797404777260022,11.0118836877786,-1.04467189974901,13.3384567373289
93.5138877220377,1.57740477726002,6.41188368777864,-1.04467189974901,10.4384567373289
107.013887722038,1.41740477726002,2.98688368777864,-4.17967189974901,5.66345673732888
89.347221055371,1.65073811059336,5.3285503544453,-1.04467189974901,2.32179007066222
129.431413495234,0.790875567638029,1.11566375650716,-4.47219767294489,10.0250546754732
101.799602007752,1.36169049154574,8.09759797349292,-1.04467189974901,27.4241710230432
226.513887722038,3.30740477726002,-16.3881163122214,-1.04467189974901,6.13845673732888
165.847221055371,3.31073811059336,-3.08811631222136,2.04532810025099,9.53845673732888
10.6249988331488,1.33851588837113,11.245217021112,-1.04467189974901,21.64956784844
88.5138877220377,1.26740477726002,4.31188368777864,-1.04467189974901,19.5384567373289
83.5138877220377,1.36740477726002,6.81188368777864,-1.04467189974901,22.7384567373289
112.513887722038,1.66740477726002,3.91188368777864,-1.04467189974901,10.2384567373289
77.6148051532303,1.45657908918663,7.12472772447588,-1.04467189974901,10.0898328841179
92.6805543887044,1.56907144392669,7.0285503544453,-1.04467189974901,10.3217900706622
94.0748633317938,1.25094136262588,6.39846905363229,-1.04467189974901,22.2811396641582
102.513887722038,1.58740477726002,4.31188368777864,-1.04467189974901,11.3384567373289
102.513887722038,1.25740477726002,3.11188368777864,-1.04467189974901,21.9384567373289
118.513887722038,0.969404777260023,5.68521702111197,-1.28667189974901,22.2184567373289
94.5138877220377,1.47740477726002,7.11188368777864,-1.04467189974901,7.73845673732888
100.263887722038,1.61490477726002,5.49938368777864,-1.04467189974901,18.6759567373289
81.4861099442599,1.34962699948224,6.34243924333419,-1.04467189974901,19.5384567373289
63.5138877220377,1.24740477726002,6.11188368777864,-1.04467189974901,20.3384567373289
74.5138877220377,1.42740477726002,6.11188368777864,-1.04467189974901,19.8384567373289
77.0138877220377,1.47740477726002,6.66188368777864,-1.04467189974901,19.5384567373289
65.0138877220377,1.23240477726002,6.56188368777864,-1.04467189974901,19.5384567373289
101.013887722038,1.51240477726002,5.56188368777864,-1.04467189974901,17.1384567373289
92.3138877220377,1.50640477726002,6.20188368777864,-1.04467189974901,19.5384567373289
140.180554388704,1.64407144392669,-1.72478297888803,-1.04467189974901,30.5051234039955
71.5138877220377,1.61740477726002,7.31188368777864,-1.04467189974901,12.9384567373289
119.763887722038,0.651779777260022,3.15875868777864,-3.92967189974901,12.0478317373289
202.013887722038,3.04240477726002,-9.58811631222136,-1.04467189974901,3.83845673732888
203.513887722038,3.01740477726002,-9.58811631222136,-1.04467189974901,11.7384567373289
215.013887722038,2.58740477726002,-11.6381163122214,-5.05467189974901,12.2884567373289
146.513887722038,1.64962699948224,-0.632560756665808,-1.04467189974901,4.98290118177333
199.024197000388,2.99853879787858,-7.92682765242755,-1.04471829150159,9.53536395382373
33.5138877220377,1.24740477726002,9.51188368777864,-1.04467189974901,20.7384567373289
146.513887722038,1.64817400802925,-0.210424004529056,-1.04467189974901,13.9230721219443
146.513887722038,1.65740477726002,-0.738116312221364,-1.04467189974901,7.08845673732888
146.513887722038,1.65740477726002,-4.58811631222136,-1.04467189974901,24.2384567373289
172.513887722038,1.63740477726002,-3.58811631222136,-1.04467189974901,24.4384567373289
146.513887722038,1.3695786903035,2.69449238343081,-1.04467189974901,22.4036741286332
202.57158002973,2.69836631572156,-7.00061631222136,-1.04467189974901,8.55595673732888
200.942459150609,2.65276192011717,-7.07740202650708,-1.04467189974901,10.2884567373289
79.5138877220377,1.23740477726002,6.11188368777864,-3.05467189974901,10.5384567373289
146.513887722038,1.26240477726002,-0.283116312221364,-4.30467189974901,10.7384567373289
146.513887722038,1.42407144392669,0.21521702111197,-1.04467189974901,20.6717900706622
146.513887722038,3.62740477726002,-4.43811631222136,3.94532810025099,27.2384567373289
146.513887722038,2.43740477726002,-0.888116312221364,-1.04467189974901,22.7384567373289
146.513887722038,1.23740477726002,1.81188368777864,-3.65467189974901,14.0384567373289
146.513887722038,1.30740477726002,3.31188368777864,-2.55467189974901,12.5384567373289
169.180554388704,3.42740477726002,-4.35478297888803,3.11199476691765,7.10512340399555
146.513887722038,2.43740477726002,-0.378116312221364,-1.04467189974901,9.53845673732888
198.113887722038,2.82340477726002,-9.68811631222136,-1.04467189974901,10.9384567373289
146.513887722038,1.68073811059336,-0.378116312221364,-1.04467189974901,11.2051234039956
204.774757287255,3.25479608160785,-6.9446380513518,-1.04506320409684,19.5384567373289
204.847221055371,3.37740477726002,-4.58811631222136,3.77866143358432,19.5384567373289
146.513887722038,1.64740477726002,0.111883687778636,-1.04467189974901,15.3384567373289
98.0138877220377,1.65740477726002,6.11188368777864,-1.04467189974901,7.93845673732888
203.513887722038,3.64740477726002,-7.08811631222136,5.44532810025099,9.53845673732888
67.3600415681915,1.47355862341387,11.2041913800863,-1.04467189974901,13.7461490450212
78.5138877220377,1.37740477726002,6.61188368777864,-1.04467189974901,22.6384567373289
126.513887722038,1.63740477726002,1.11188368777864,-1.04467189974901,27.4384567373289
118.695705903856,1.64831386816911,1.65733823323318,-1.04467189974901,6.31118401005616
57.5138877220377,1.62740477726002,-0.288116312221364,-1.04467189974901,20.3384567373289
146.513887722038,0.617404777260022,-1.08811631222136,-2.75467189974901,10.7384567373289
146.513887722038,2.43740477726002,-0.378116312221364,-1.04467189974901,12.4384567373289
133.724414037827,1.64372056673371,-3.36180052274768,-1.04467189974901,48.7752988425921
237.513887722038,3.90135214568107,-15.3775899964319,3.24006494235625,4.12793042153941
212.180554388704,3.89573811059336,-15.6381163122214,4.69532810025099,12.8717900706622
221.013887722038,3.85240477726002,-12.5881163122214,7.24532810025099,17.7884567373289
171.513887722038,3.30740477726002,-3.48811631222136,2.04532810025099,5.13845673732888
141.513887722038,1.41740477726002,-0.378116312221364,-4.05467189974901,11.0384567373289
204.013887722038,3.08240477726002,-7.83811631222136,-1.04467189974901,17.9884567373289
146.513887722038,1.64296033281558,-0.378116312221364,-1.04467189974901,9.53845673732888
205.013887722038,2.77990477726002,-9.63811631222136,-1.04467189974901,9.53845673732888
146.513887722038,1.62740477726002,-1.98811631222136,-1.04467189974901,17.0384567373289
192.513887722038,2.32740477726002,-7.38811631222136,-1.04467189974901,9.03845673732888
191.069443277593,1.63851588837113,-5.13256075666581,-1.04467189974901,16.3940122928844
146.513887722038,1.66740477726002,-0.378116312221364,-1.04467189974901,-1.56154326267112
156.513887722038,2.32740477726002,-0.988116312221364,-3.05467189974901,11.6384567373289
146.513887722038,1.63740477726002,-0.378116312221364,-1.04467189974901,9.03845673732888
94.5138877220377,1.25740477726002,5.11188368777864,-3.75467189974901,11.9384567373289
202.913887722038,3.86140477726002,-8.52811631222136,3.96532810025099,17.0384567373289
202.847221055371,4.03740477726002,-8.15478297888803,5.01199476691765,17.7051234039956
146.513887722038,0.657404777260022,1.11188368777864,-5.45467189974901,11.0384567373289
103.513887722038,1.62740477726002,-4.98811631222136,-1.04467189974901,18.3384567373289
205.513887722038,3.43740477726002,-5.08811631222136,2.95532810025099,18.5384567373289
146.513887722038,1.63740477726002,1.11188368777864,-1.04467189974901,15.7384567373289
146.513887722038,1.64740477726002,-0.378116312221364,-1.04467189974901,19.5384567373289
166.513887722038,1.65740477726002,-1.38811631222136,-1.56467189974901,19.5384567373289
199.013887722038,3.20740477726002,-11.9381163122214,1.69532810025099,-1.26154326267112
210.180554388704,3.40073811059336,-6.38811631222136,1.11199476691765,18.5717900706622
210.561506769657,3.31478572964097,-8.88811631222136,4.54532810025099,10.8077787041549
209.847221055371,3.45740477726002,-9.7214496455547,4.54532810025099,13.4051234039956
164.513887722038,3.16740477726002,-2.54811631222136,-1.04467189974901,13.5384567373289
146.513887722038,1.66740477726002,-0.188116312221364,-1.04467189974901,11.2784567373289
146.513887722038,1.62440477726002,0.291883687778636,-1.04467189974901,10.5484567373289
217.847221055371,3.49407144392669,-9.75478297888803,2.54532810025099,18.6717900706622
229.013887722038,3.85740477726002,-9.88811631222136,-1.04467189974901,19.5384567373289
191.388887722038,3.78323811059336,-11.6631163122214,5.64949476691765,21.0592900706622
184.513887722038,1.62740477726002,-5.98811631222136,-1.04467189974901,10.9384567373289
13.5138877220377,0.487404777260022,11.0118836877786,-1.04467189974901,21.7384567373289
146.513887722038,2.22740477726002,-0.378116312221364,-1.04467189974901,6.98845673732888
198.513887722038,2.86740477726002,-1.97811631222136,-1.04467189974901,19.5384567373289
194.180554388704,3.54407144392669,-9.1214496455547,4.97866143358432,13.1384567373289
71.5138877220377,1.65740477726002,6.21188368777864,5.94532810025099,20.9384567373289
206.332069540219,3.2692229590782,-8.78811631222136,-1.04467189974901,18.9657294646016
117.513887722038,1.63740477726002,1.71188368777864,-1.04467189974901,5.23845673732888
203.23610994426,3.17351588837113,-9.68811631222136,-1.04467189974901,7.26067895955111
95.847221055371,1.64407144392669,1.44521702111197,-1.04467189974901,19.5384567373289
125.513887722038,2.15740477726002,0.611883687778636,-1.04467189974901,15.5384567373289
182.513887722038,3.18740477726002,-4.7214496455547,4.64532810025099,14.7384567373289
173.513887722038,3.20740477726002,-4.88811631222136,4.55532810025099,16.9384567373289
96.2411604493104,1.41740477726002,3.21188368777864,-1.04467189974901,20.5384567373289
119.513887722038,0.907404777260022,6.11188368777864,-1.04467189974901,22.5384567373289
201.513887722038,4.23740477726002,-5.28811631222136,6.44532810025099,5.63845673732888
177.513887722038,3.67740477726002,-11.3881163122214,5.94532810025099,18.4384567373289
155.513887722038,2.94740477726002,-2.38811631222136,-4.35467189974901,16.5384567373289
146.513887722038,1.60740477726002,1.91188368777864,-4.15467189974901,24.5384567373289
146.513887722038,3.03740477726002,-0.888116312221364,-1.04467189974901,-4.26154326267112
146.513887722038,1.64740477726002,0.611883687778636,-1.04467189974901,16.8384567373289
85.5138877220377,1.58740477726002,7.11188368777864,-1.04467189974901,12.5384567373289
146.513887722038,1.66740477726002,-0.378116312221364,-1.04467189974901,7.33845673732888
170.513887722038,3.27740477726002,-4.38811631222136,1.94532810025099,21.5384567373289
142.513887722038,1.33740477726002,0.121883687778636,-1.04467189974901,23.2384567373289
203.513887722038,3.39740477726002,-9.71311631222136,-1.04467189974901,18.2384567373289
188.013887722038,2.86740477726002,-9.43811631222136,-1.04467189974901,7.18845673732888
194.203281661432,3.4617229590782,-6.81766176676682,-1.04467189974901,19.5384567373289
201.513887722038,3.62740477726002,-6.68811631222136,5.54532810025099,9.53845673732888
146.513887722038,1.66240477726002,-0.378116312221364,-1.04467189974901,4.68845673732888
100.513887722038,1.64240477726002,3.11688368777864,-1.04467189974901,19.5384567373289

"""

BOUNDS_UPPER_CSV = """capi,hplc,ief,agaracid,reverse
153.486112277962,1.79099522273998,0.398116312221364,1.06467189974901,10.4615432626711
246.486112277962,2.89995522273998,1.20131631222136,1.06467189974901,17.5579761693711
180.736112277962,2.79009522273998,-3.08688368777864,4.25467189974901,10.2890432626711
229.819445611296,4.26259522273998,-12.4785503544453,8.22133856641568,8.99487659600445
209.486112277962,3.39759522273998,-6.36188368777864,1.06467189974901,20.6165432626711
125.486112277962,1.48759522273998,4.08811631222136,-1.44532810025099,14.8615432626711
153.486112277962,1.79259522273998,-1.11188368777864,0.0546718997490123,19.9615432626711
88.4861122779623,1.52259522273998,7.18811631222136,1.06467189974901,9.26154326267112
153.486112277962,1.78259522273998,-0.311883687778636,1.06467189974901,21.0615432626711
222.486112277962,3.54926188940664,-8.7785503544453,3.05800523308235,20.4615432626711
165.366112277962,1.80179522273998,-0.855883687778637,0.984391899749012,10.6819432626711
119.986112277962,1.47259522273998,4.43811631222136,-1.39532810025099,24.0615432626711
153.486112277962,1.52259522273998,0.398116312221364,1.06467189974901,21.5615432626711
187.486112277962,3.75259522273998,-7.31188368777864,7.55467189974901,21.8615432626711
215.486112277962,3.34259522273998,-7.21188368777864,1.06467189974901,4.96154326267112
172.486112277962,3.59259522273998,-3.41188368777864,6.65467189974901,9.86154326267112
210.486112277962,3.25759522273998,-7.31188368777864,1.06467189974901,15.9615432626711
153.486112277962,1.81259522273998,0.398116312221364,1.06467189974901,20.4615432626711
153.486112277962,1.79259522273998,0.498116312221364,1.06467189974901,24.6615432626711
153.486112277962,1.36759522273998,1.48811631222136,-2.44532810025099,14.4115432626711
153.486112277962,1.80259522273998,-3.11188368777864,1.06467189974901,19.2615432626711
179.236112277962,3.80134522273998,-4.43688368777864,7.39217189974901,19.5240432626711
161.486112277962,1.85259522273998,-0.111883687778636,1.06467189974901,12.4615432626711
153.486112277962,1.81259522273998,0.888116312221364,1.06467189974901,8.76154326267112
153.486112277962,1.37759522273998,0.398116312221364,1.06467189974901,22.8615432626711
255.086112277962,4.46019522273998,-15.6118836877786,11.054671899749,8.42494914605742
226.486112277962,3.52259522273998,-10.3118836877786,3.15467189974901,2.96154326267112
136.986112277962,1.31759522273998,2.73811631222136,-0.895328100250988,11.6115432626711
145.048612277962,0.872595222739978,2.56999131222136,-1.43282810025099,14.0677932626711
153.486112277962,1.80259522273998,0.588116312221364,1.06467189974901,10.6715432626711
201.486112277962,3.82926188940664,-8.44521702111197,1.06467189974901,18.8282099293378
246.486112277962,4.13259522273998,-10.3618836877786,7.30467189974901,18.7615432626711
163.486112277962,2.57259522273998,0.0881163122213637,1.06467189974901,29.3615432626711
195.486112277962,3.24259522273998,-5.91188368777864,1.06467189974901,17.6615432626711
153.486112277962,1.80759522273998,-0.628550354445303,1.06467189974901,14.7948765960044
235.486112277962,4.07259522273998,-8.81188368777864,6.05467189974901,18.3615432626711
153.486112277962,1.81259522273998,0.398116312221364,1.06467189974901,12.7615432626711
181.986112277962,2.22759522273998,-2.81188368777864,1.06517189974901,10.4615432626711
267.486112277962,4.60259522273998,-16.6118836877786,6.56467189974901,18.7615432626711
217.486112277962,1.51259522273998,-10.4118836877786,-1.14532810025099,10.8615432626711
153.486112277962,1.81259522273998,0.398116312221364,1.06467189974901,10.4615432626711
214.486112277962,3.22259522273998,-8.11188368777864,1.06467189974901,8.86154326267112
203.057540849391,2.71580950845426,-6.85474083063578,1.06467189974901,9.1472575483854
210.01672452286,2.85402379416855,-6.75678164696231,1.06467189974901,8.94521673205887
211.200397992248,3.2583797660655,-6.91352303204093,1.06467189974901,8.85360415260086
215.486112277962,1.81259522273998,-4.61188368777864,1.06467189974901,20.4615432626711
162.486112277962,1.76259522273998,-0.311883687778636,1.06467189974901,6.76154326267112
153.486112277962,1.80259522273998,0.588116312221364,1.06467189974901,17.4615432626711
190.986112277962,2.79759522273998,-4.81688368777864,1.06467189974901,10.4615432626711
182.486112277962,1.79259522273998,-3.61188368777864,1.06467189974901,21.1615432626711
153.486112277962,2.65759522273998,0.443116312221364,1.06467189974901,18.3115432626711
226.486112277962,4.18259522273998,-12.2118836877786,1.06467189974901,6.76154326267112
174.986112277962,3.25259522273998,-6.51188368777864,1.06467189974901,20.4615432626711
231.343255135105,2.83816665131141,-14.8475979734929,1.06467189974901,5.82613696253939
245.486112277962,3.27402379416855,-14.9118836877786,1.06467189974901,7.5472575483854
185.486112277962,1.78259522273998,-2.61188368777864,1.06467189974901,21.9615432626711
124.486112277962,1.67259522273998,3.88811631222136,1.06467189974901,12.9615432626711
153.486112277962,1.79259522273998,0.398116312221364,1.06467189974901,25.0615432626711
153.486112277962,2.59259522273998,1.64965477375983,1.06467189974901,19.7307740319019
218.986112277962,2.99650147273998,-8.57750868777864,1.06467189974901,20.4615432626711
215.940657732508,2.90259522273998,-9.09370186959682,1.06467189974901,9.90699780812566
202.361112277962,2.64134522273998,-6.09938368777863,1.06467189974901,11.6865432626711
185.486112277962,1.81259522273998,-3.51188368777864,1.06467189974901,29.7115432626711
200.486112277962,3.48259522273998,-8.11188368777864,1.06467189974901,20.4615432626711
209.321933173485,3.3888638794564,-6.37233144897267,1.06467189974901,18.630199979089
184.486112277962,1.77259522273998,-3.81188368777864,1.06467189974901,19.0615432626711
184.819445611296,3.63148411162887,-4.84521702111197,7.16578301086012,9.25043215156001
201.986112277962,4.42759522273998,-11.4118836877786,11.054671899749,7.91154326267112
210.486112277962,3.68259522273998,-5.61188368777864,6.65467189974901,9.16154326267112
188.736112277962,3.68759522273998,-5.98688368777864,5.45467189974901,17.3115432626711
210.486112277962,3.50259522273998,-7.41188368777864,1.06467189974901,20.4615432626711
174.486112277962,3.25759522273998,-5.36188368777864,1.06467189974901,19.9115432626711
153.486112277962,2.65759522273998,0.398116312221364,1.06467189974901,20.4615432626711
183.486112277962,1.83259522273998,-4.01188368777864,1.06467189974901,20.4615432626711
209.486112277962,3.49759522273998,-8.31188368777864,5.55467189974901,20.1615432626711
103.100147365682,1.6461039946698,5.54776543502838,1.06467189974901,29.1703151924957
181.486112277962,1.68259522273998,-2.71188368777864,1.06467189974901,25.1615432626711
153.486112277962,1.78659522273998,0.398116312221364,1.06467189974901,43.4615432626711
183.486112277962,3.60259522273998,-5.01188368777864,7.55467189974901,10.4615432626711
153.486112277962,1.82259522273998,0.398116312221364,1.06467189974901,12.3615432626711
216.152778944629,3.59592855607331,-6.71188368777864,1.06467189974901,19.0948765960044
153.486112277962,1.84259522273998,1.48811631222136,1.06467189974901,4.46154326267112
221.962302754153,4.29021427035903,-8.73140749730245,7.27848142355854,19.3234480245759
153.486112277962,1.78259522273998,2.68811631222136,1.06467189974901,20.1615432626711
44.4861122779623,0.942595222739978,11.7881163122214,1.06467189974901,14.2615432626711
100.486112277962,1.72259522273998,7.18811631222136,1.06467189974901,11.3615432626711
113.986112277962,1.56259522273998,3.76311631222136,-2.07032810025099,6.58654326267112
96.3194456112956,1.79592855607331,6.10478297888803,1.06467189974901,3.24487659600445
136.403638051158,0.936066013117984,1.89189638094989,-2.36285387344686,10.9481412008154
108.771826563677,1.50688093702569,8.87383059793565,1.06467189974901,28.3472575483854
233.486112277962,3.45259522273998,-15.6118836877786,1.06467189974901,7.06154326267112
172.819445611296,3.45592855607331,-2.31188368777864,4.15467189974901,10.4615432626711
17.5972233890734,1.48370633385109,12.0214496455547,1.06467189974901,22.5726543737822
95.4861122779623,1.41259522273998,5.08811631222136,1.06467189974901,20.4615432626711
90.4861122779623,1.51259522273998,7.58811631222136,1.06467189974901,23.6615432626711
119.486112277962,1.81259522273998,4.68811631222136,1.06467189974901,11.1615432626711
84.587029709155,1.60176953466658,7.90096034891861,1.06467189974901,11.0129194094601
99.652778944629,1.71426188940664,7.80478297888803,1.06467189974901,11.2448765960044
101.047087887718,1.39613180810583,7.17470167807502,1.06467189974901,23.2042261895004
109.486112277962,1.73259522273998,5.08811631222136,1.06467189974901,12.2615432626711
109.486112277962,1.40259522273998,3.88811631222136,1.06467189974901,22.8615432626711
125.486112277962,1.11459522273998,6.4614496455547,0.822671899749012,23.1415432626711
101.486112277962,1.62259522273998,7.88811631222136,1.06467189974901,8.66154326267112
107.236112277962,1.76009522273998,6.27561631222136,1.06467189974901,19.5990432626711
88.4583345001845,1.4948174449622,7.11867186777692,1.06467189974901,20.4615432626711
70.4861122779623,1.39259522273998,6.88811631222136,1.06467189974901,21.2615432626711
81.4861122779623,1.57259522273998,6.88811631222136,1.06467189974901,20.7615432626711
83.9861122779623,1.62259522273998,7.43811631222136,1.06467189974901,20.4615432626711
71.9861122779623,1.37759522273998,7.33811631222136,1.06467189974901,20.4615432626711
107.986112277962,1.65759522273998,6.33811631222136,1.06467189974901,18.0615432626711
99.2861122779623,1.65159522273998,6.97811631222136,1.06467189974901,20.4615432626711
147.152778944629,1.78926188940664,-0.948550354445303,1.06467189974901,31.4282099293378
78.4861122779623,1.76259522273998,8.08811631222136,1.06467189974901,13.8615432626711
126.736112277962,0.796970222739978,3.93499131222136,-1.82032810025099,12.9709182626711
208.986112277962,3.18759522273998,-8.81188368777864,1.06467189974901,4.76154326267112
210.486112277962,3.16259522273998,-8.81188368777864,1.06467189974901,12.6615432626711
221.986112277962,2.73259522273998,-10.8618836877786,-2.94532810025099,13.2115432626711
153.486112277962,1.7948174449622,0.143671867776919,1.06467189974901,5.90598770711556
205.996421556313,3.14372924335853,-7.15059502798482,1.06462550799644,10.458450479166
40.4861122779623,1.39259522273998,10.2881163122214,1.06467189974901,21.6615432626711
153.486112277962,1.79336445350921,0.565808619913671,1.06467189974901,14.8461586472865
153.486112277962,1.80259522273998,0.0381163122213637,1.06467189974901,8.01154326267111
153.486112277962,1.80259522273998,-3.81188368777864,1.06467189974901,25.1615432626711
179.486112277962,1.78259522273998,-2.81188368777864,1.06467189974901,25.3615432626711
153.486112277962,1.51476913578346,3.47072500787354,1.06467189974901,23.3267606539755
209.543804585655,2.84355676120152,-6.22438368777864,1.06467189974901,9.47904326267112
207.914683706534,2.79795236559712,-6.30116940206435,1.06467189974901,11.2115432626711
86.4861122779623,1.38259522273998,6.88811631222136,-0.945328100250988,11.4615432626711
153.486112277962,1.40759522273998,0.493116312221364,-2.19532810025099,11.6615432626711
153.486112277962,1.56926188940664,0.991449645554697,1.06467189974901,21.5948765960045
153.486112277962,3.77259522273998,-3.66188368777864,6.05467189974901,28.1615432626711
153.486112277962,2.58259522273998,-0.111883687778636,1.06467189974901,23.6615432626711
153.486112277962,1.38259522273998,2.58811631222136,-1.54532810025099,14.9615432626711
153.486112277962,1.45259522273998,4.08811631222136,-0.445328100250988,13.4615432626711
176.152778944629,3.57259522273998,-3.5785503544453,5.22133856641568,8.02820992933778
153.486112277962,2.58259522273998,0.398116312221364,1.06467189974901,10.4615432626711
205.086112277962,2.96859522273998,-8.91188368777864,1.06467189974901,11.8615432626711
153.486112277962,1.82592855607331,0.398116312221364,1.06467189974901,12.1282099293378
211.74698184318,3.3999865270878,-6.16840542690907,1.06428059540119,20.4615432626711
211.819445611296,3.52259522273998,-3.81188368777864,5.88800523308235,20.4615432626711
153.486112277962,1.79259522273998,0.888116312221364,1.06467189974901,16.2615432626711
104.986112277962,1.80259522273998,6.88811631222136,1.06467189974901,8.86154326267112
210.486112277962,3.79259522273998,-6.31188368777864,7.55467189974901,10.4615432626711
74.3322661241162,1.61874906889382,11.9804240045291,1.06467189974901,14.6692355703634
85.4861122779623,1.52259522273998,7.38811631222136,1.06467189974901,23.5615432626711
133.486112277962,1.78259522273998,1.88811631222136,1.06467189974901,28.3615432626711
125.667930459781,1.79350431364907,2.43357085767591,1.06467189974901,7.23427053539839
64.4861122779623,1.77259522273998,0.488116312221364,1.06467189974901,21.2615432626711
153.486112277962,0.762595222739978,-0.311883687778636,-0.645328100250988,11.6615432626711
153.486112277962,2.58259522273998,0.398116312221364,1.06467189974901,13.3615432626711
140.696638593752,1.78891101221366,-2.58556789830495,1.06467189974901,49.6983853679343
244.486112277962,4.04654259116103,-14.6013573719892,5.34940874185428,5.05101694688164
219.152778944629,4.04092855607331,-14.8618836877786,6.80467189974901,13.7948765960044
227.986112277962,3.99759522273998,-11.8118836877786,9.35467189974901,18.7115432626711
178.486112277962,3.45259522273998,-2.71188368777864,4.15467189974901,6.06154326267112
148.486112277962,1.56259522273998,0.398116312221364,-1.94532810025099,11.9615432626711
210.986112277962,3.22759522273998,-7.06188368777864,1.06467189974901,18.9115432626711
153.486112277962,1.78815077829553,0.398116312221364,1.06467189974901,10.4615432626711
211.986112277962,2.92509522273998,-8.86188368777864,1.06467189974901,10.4615432626711
153.486112277962,1.77259522273998,-1.21188368777864,1.06467189974901,17.9615432626711
199.486112277962,2.47259522273998,-6.61188368777864,1.06467189974901,9.96154326267112
198.041667833518,1.78370633385109,-4.35632813222308,1.06467189974901,17.3170988182267
153.486112277962,1.81259522273998,0.398116312221364,1.06467189974901,-0.638456737328884
163.486112277962,2.47259522273998,-0.211883687778636,-0.945328100250988,12.5615432626711
153.486112277962,1.78259522273998,0.398116312221364,1.06467189974901,9.96154326267112
101.486112277962,1.40259522273998,5.88811631222136,-1.64532810025099,12.8615432626711
209.886112277962,4.00659522273998,-7.75188368777864,6.07467189974901,17.9615432626711
209.819445611296,4.18259522273998,-7.3785503544453,7.12133856641568,18.6282099293378
153.486112277962,0.802595222739978,1.88811631222136,-3.34532810025099,11.9615432626711
110.486112277962,1.77259522273998,-4.21188368777864,1.06467189974901,19.2615432626711
212.486112277962,3.58259522273998,-4.31188368777864,5.06467189974901,19.4615432626711
153.486112277962,1.78259522273998,1.88811631222136,1.06467189974901,16.6615432626711
153.486112277962,1.79259522273998,0.398116312221364,1.06467189974901,20.4615432626711
173.486112277962,1.80259522273998,-0.611883687778636,0.544671899749012,20.4615432626711
205.986112277962,3.35259522273998,-11.1618836877786,3.80467189974901,-0.338456737328884
217.152778944629,3.54592855607331,-5.61188368777864,3.22133856641568,19.4948765960044
217.533731325581,3.45997617512093,-8.11188368777864,6.65467189974901,11.7308652294971
216.819445611296,3.60259522273998,-8.94521702111197,6.65467189974901,14.3282099293378
171.486112277962,3.31259522273998,-1.77188368777864,1.06467189974901,14.4615432626711
153.486112277962,1.81259522273998,0.588116312221364,1.06467189974901,12.2015432626711
153.486112277962,1.76959522273998,1.06811631222136,1.06467189974901,11.4715432626711
224.819445611296,3.63926188940664,-8.9785503544453,4.65467189974901,19.5948765960044
235.986112277962,4.00259522273998,-9.11188368777864,1.06467189974901,20.4615432626711
198.361112277962,3.92842855607331,-10.8868836877786,7.75883856641568,21.9823765960044
191.486112277962,1.77259522273998,-5.21188368777864,1.06467189974901,11.8615432626711
20.4861122779623,0.632595222739978,11.7881163122214,1.06467189974901,22.6615432626711
153.486112277962,2.37259522273998,0.398116312221364,1.06467189974901,7.91154326267112
205.486112277962,3.01259522273998,-1.20188368777864,1.06467189974901,20.4615432626711
201.152778944629,3.68926188940664,-8.34521702111197,7.08800523308235,14.0615432626711
78.4861122779623,1.80259522273998,6.98811631222136,8.05467189974901,21.8615432626711
213.304294096144,3.41441340455816,-8.01188368777864,1.06467189974901,19.8888159899438
124.486112277962,1.78259522273998,2.48811631222136,1.06467189974901,6.16154326267112
210.208334500185,3.31870633385109,-8.91188368777864,1.06467189974901,8.18376548489334
102.819445611296,1.78926188940664,2.2214496455547,1.06467189974901,20.4615432626711
132.486112277962,2.30259522273998,1.38811631222136,1.06467189974901,16.4615432626711
189.486112277962,3.33259522273998,-3.94521702111197,6.75467189974901,15.6615432626711
180.486112277962,3.35259522273998,-4.11188368777864,6.66467189974901,17.8615432626711
103.213385005235,1.56259522273998,3.98811631222136,1.06467189974901,21.4615432626711
126.486112277962,1.05259522273998,6.88811631222136,1.06467189974901,23.4615432626711
208.486112277962,4.38259522273998,-4.51188368777864,8.55467189974901,6.56154326267112
184.486112277962,3.82259522273998,-10.6118836877786,8.05467189974901,19.3615432626711
162.486112277962,3.09259522273998,-1.61188368777864,-2.24532810025099,17.4615432626711
153.486112277962,1.75259522273998,2.68811631222136,-2.04532810025099,25.4615432626711
153.486112277962,3.18259522273998,-0.111883687778636,1.06467189974901,-3.33845673732888
153.486112277962,1.79259522273998,1.38811631222136,1.06467189974901,17.7615432626711
92.4861122779623,1.73259522273998,7.88811631222136,1.06467189974901,13.4615432626711
153.486112277962,1.81259522273998,0.398116312221364,1.06467189974901,8.26154326267111
177.486112277962,3.42259522273998,-3.61188368777864,4.05467189974901,22.4615432626711
149.486112277962,1.48259522273998,0.898116312221364,1.06467189974901,24.1615432626711
210.486112277962,3.54259522273998,-8.93688368777864,1.06467189974901,19.1615432626711
194.986112277962,3.01259522273998,-8.66188368777864,1.06467189974901,8.11154326267112
201.175506217356,3.60691340455816,-6.04142914232409,1.06467189974901,20.4615432626711
208.486112277962,3.77259522273998,-5.91188368777864,7.65467189974901,10.4615432626711
153.486112277962,1.80759522273998,0.398116312221364,1.06467189974901,5.61154326267112
107.486112277962,1.78759522273998,3.89311631222136,1.06467189974901,20.4615432626711

"""

BOUNDS_MARGIN_CSV = """
Row,capi,hplc,ief,agaracid,reverse
l_bound,-3.48611227796231,-0.0725952227399776,-0.388116312221364,-1.05467189974901,-0.461543262671116
u_bound,3.48611227796231,0.0725952227399776,0.388116312221364,1.05467189974901,0.461543262671116

"""

HIGHLIGHT_VARIANTS_JSON = """
[
    "A","A2","S","C","E","Lepore","D Punjab","O Arab","S-Antilles","Lepore Baltimore"
]
"""

# === Conversion en DataFrames / objets Python ===
variant_mean = pd.read_csv(StringIO(VARIANT_MEAN_CSV))
bounds_lower = pd.read_csv(StringIO(BOUNDS_LOWER_CSV))
bounds_upper = pd.read_csv(StringIO(BOUNDS_UPPER_CSV))
bounds_margin = pd.read_csv(StringIO(BOUNDS_MARGIN_CSV), index_col=0)
highlight_variants = json.loads(HIGHLIGHT_VARIANTS_JSON)


methods = list(bounds_lower.columns)

st.title("🩸 Diagnostic HbX inconnu")

# === Interface utilisateur ===
st.sidebar.header("⚙️ Paramètres")
input_vals = {}
selected_methods = []

for m in methods:
    val = st.sidebar.text_input(f"Valeur mesurée pour {m} :", "")
    if val.strip() != "":
        input_vals[m] = float(val)
        selected_methods.append(m)

if not selected_methods:
    st.warning("👉 Entrez au moins une valeur pour continuer.")
    st.stop()

st.write("### Méthodes sélectionnées :", selected_methods)

# === Calcul des distances ===
vm_data = variant_mean[["mean_" + m for m in selected_methods]].to_numpy()
vi_data = np.array([input_vals[m] for m in selected_methods])

# Normalisation Z-score
vm_norm = (vm_data - vm_data.mean(axis=0)) / vm_data.std(axis=0, ddof=1)
vi_norm = (vi_data - vm_data.mean(axis=0)) / vm_data.std(axis=0, ddof=1)

distances = np.linalg.norm(vm_norm - vi_norm, axis=1)

# Appliquer les bornes
lb = bounds_lower[selected_methods].to_numpy()
ub = bounds_upper[selected_methods].to_numpy()
vi_lb = vi_data + bounds_margin.loc["l_bound", selected_methods].to_numpy()
vi_ub = vi_data + bounds_margin.loc["u_bound", selected_methods].to_numpy()

mask = np.all((vi_lb <= ub) & (vi_ub >= lb), axis=1)
distances[~mask] = np.inf

variant_mean["distance"] = distances

# === Résultat principal ===
valid_variants = variant_mean[np.isfinite(variant_mean["distance"])]
if not valid_variants.empty:
    valid_sorted = valid_variants.sort_values("distance")
    predicted = valid_sorted.iloc[0]["variant"]
    st.success(f"✅ Variant prédit : **{predicted}**")
else:
    predicted = None
    st.warning("⚠️ Aucun variant compatible trouvé.")



# --- Variables défensives pour couleurs ---
if "highlight_variants" not in globals():
    highlight_variants = []
if "covariants_selected" not in globals():
    covariants_selected = []
if "covariants_5m" not in globals():
    covariants_5m = []



# === Figure 4 : top n_firstDistances compatibles ===
st.subheader("Top VM les plus proches")

n_firstDistances = 30
finite_idx = np.where(np.isfinite(variant_mean["distance"]))[0]
finite_sorted_idx = finite_idx[np.argsort(variant_mean.loc[finite_idx, "distance"].values)]
n_display = min(n_firstDistances, len(finite_sorted_idx))

if n_display > 0:
    plot_idx = finite_sorted_idx[:n_display]
    plot_distances = variant_mean.loc[plot_idx, "distance"].values
    plot_vms = variant_mean.loc[plot_idx, "variant"].values

    colors = []
    for vm in plot_vms:
        if vm in highlight_variants:
            colors.append("red")
        elif vm == predicted:
            colors.append("darkblue")
        elif vm in covariants_selected:
            colors.append("#3366cc")  # bleu moyen
        elif vm in covariants_5m:
            colors.append("#99ccff")  # bleu clair
        else:
            colors.append("#3366cc")  # 🔵 compatible (par défaut en bleu)
    
    fig, ax = plt.subplots()
    bars = ax.bar(plot_vms, plot_distances, color=colors)
    ax.set_xticklabels(plot_vms, rotation=45, ha="right")
    ax.set_ylabel("Distance Euclidienne")
    ax.set_title("Top VM compatibles")
    st.pyplot(fig)



# === Figure 7 : top 50 VM toutes distances ===
st.subheader("Top 50 VM par distance")

# ⚠️ recalcul sans filtrer les incompatibles
vm_norm = (vm_data - vm_data.mean(axis=0)) / vm_data.std(axis=0, ddof=1)
vi_norm = (vi_data - vm_data.mean(axis=0)) / vm_data.std(axis=0, ddof=1)
distances_all = np.linalg.norm(vm_norm - vi_norm, axis=1)

sorted_idx_all = np.argsort(distances_all)
plot_idx = sorted_idx_all[:50]
plot_distances = distances_all[plot_idx]
plot_vms = variant_mean.loc[plot_idx, "variant"].values

colors = []
for i, vmname in enumerate(plot_vms):
    if vmname in highlight_variants:
        colors.append("red")
    elif vmname == predicted:
        colors.append("darkblue")
    elif mask[plot_idx[i]]:  # compatible
        colors.append("#3366cc")
    else:  # incompatible
        colors.append("lightgrey")


fig, ax = plt.subplots()
bars = ax.bar(plot_vms, plot_distances, color=colors)
ax.set_xticklabels(plot_vms, rotation=45, ha="right")
ax.set_ylabel("Distance Euclidienne")
ax.set_xlabel("Variants (Top 50 triés par distance)")
ax.set_title("Top 50 VM (compatibles en bleu, incompatibles en gris, highlights en rouge)")
st.pyplot(fig)


# === Figure 5 : scatter des deux premières méthodes ===
if len(selected_methods) >= 2:
    st.subheader("Vue globale des deux premières méthodes")
    method_x, method_y = selected_methods[:2]
    vi_x, vi_y = input_vals[method_x], input_vals[method_y]

    vm_x = variant_mean["mean_" + method_x].values
    vm_y = variant_mean["mean_" + method_y].values

    highlight_mask = np.isin(variant_mean["variant"].values, highlight_variants)

    fig, ax = plt.subplots()
    ax.scatter(vm_x, vm_y, c="k", s=30)
    ax.scatter(vm_x[highlight_mask], vm_y[highlight_mask], c="r", s=50)
    
    # Labels pour highlights
    for i, txt in enumerate(variant_mean["variant"].values):
        if highlight_mask[i]:
            ax.text(vm_x[i]+0.01, vm_y[i]+0.01, txt, fontsize=8, color="r")

    # Barres d'erreur HbX
    vi_x_err_neg = abs(2 * bounds_margin.loc["l_bound", method_x])
    vi_x_err_pos = abs(2 * bounds_margin.loc["u_bound", method_x])
    vi_y_err_neg = abs(2 * bounds_margin.loc["l_bound", method_y])
    vi_y_err_pos = abs(2 * bounds_margin.loc["u_bound", method_y])
    ax.errorbar(vi_x, vi_y, yerr=[[vi_y_err_neg], [vi_y_err_pos]],
                xerr=[[vi_x_err_neg], [vi_x_err_pos]],
                fmt='o', color='b', ecolor='b', capsize=5, lw=1.5, mec='b', mfc='b')

    ax.set_xlabel(method_x)
    ax.set_ylabel(method_y)
    ax.set_title("Vue globale (rouge = principaux, bleu = HbX)")
    st.pyplot(fig)

# === Figure 6 : zoom sur VM compatibles ===
if len(selected_methods) >= 2:
    st.subheader("Zoom sur VM compatibles")
    compat_idx = np.isfinite(variant_mean["distance"])
    vm_candidates = variant_mean.loc[compat_idx, "variant"].values
    vm_x_cand = variant_mean.loc[compat_idx, "mean_" + method_x].values
    vm_y_cand = variant_mean.loc[compat_idx, "mean_" + method_y].values

    highlight_cand_mask = np.isin(vm_candidates, highlight_variants)

    fig, ax = plt.subplots()
    ax.scatter(vm_x_cand, vm_y_cand, c='k', s=30)
    for i, txt in enumerate(vm_candidates):
        dx = 0.01 * (vm_x_cand.max()-vm_x_cand.min())
        dy = 0.01 * (vm_y_cand.max()-vm_y_cand.min())
        if highlight_cand_mask[i]:
            ax.text(vm_x_cand[i]+dx, vm_y_cand[i]+dy, txt, fontsize=8, color='r', fontweight='bold')
        else:
            ax.text(vm_x_cand[i]+dx, vm_y_cand[i]+dy, txt, fontsize=8, color='k')

    ax.errorbar(vi_x, vi_y, yerr=[[vi_y_err_neg], [vi_y_err_pos]],
                xerr=[[vi_x_err_neg], [vi_x_err_pos]],
                fmt='o', color='b', ecolor='b', capsize=5, lw=1.5, mec='b', mfc='b')
    ax.text(vi_x+dx, vi_y+3*dy, "HbX", fontsize=10, color='b', fontweight='bold')

    ax.set_xlabel(method_x)
    ax.set_ylabel(method_y)
    ax.set_title("Zoom sur VM compatibles")
    st.pyplot(fig)






